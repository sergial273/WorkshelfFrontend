<div id="ht-tm-jumbotron">
  <div class="jumbotron py-0 bg-light text-dark mb-0 radius-0 ht-tm-jumbotron">
    <div class="container">
      <div class="row">

        <!-- LEFT SIDE -->
        <div class="col-md-6 col-lg-6 order-2 order-md-1">
          <div class="card shadow-sm book-card my-2 py-5">
            <div class="card-body">
              <div class="row">
                <div class="col-md-6 col-lg-6">
                  <img src="{{ book.image }}" alt="{{ book.title }}" class="card-img-top mb-3" />
                </div>
                <div class="col-md-6 col-lg-6">
                  <h2 class="display-4 mb-2">{{ book.title }}</h2>
                  <p class="text-spacey">Author: <span class="text-merriweather">{{ book.author }}</span></p>
                  <p class="text-spacey">Genre: <span class="text-merriweather">{{ book.genre }}</span></p>
                  <p class="text-spacey">Publisher: <span class="text-merriweather">{{ book.editorial.editorialName
                      }}</span></p>
                  @if (book.reserved === 0) {
                  <p class="text-spacey">Reservation status: <span class="text-merriweather">Available</span></p>
                  } @else if (book.reserved === 1) {
                  <p class="text-spacey">Reservation status: <span class="text-merriweather">Reserved</span></p>
                  <p class="text-spacey">Reservation until: <span class="text-merriweather">{{ (book.reservationDuration
                      | date) }}</span></p>
                  } @else if (book.reserved === 2) {
                  <p class="text-spacey">Reservation status: <span class="text-merriweather">Lost</span></p>
                  } @else if (book.reserved === 3) {
                  <p class="text-spacey">Reservation status: <span class="text-merriweather">Not available</span></p>
                  }
                  <div class="mt-3">
                    @if (isAvailable) {
                    <button class="btn btn-dark btn-lg my-2 mr-2 text-oswald btn-wide js-ht-download-link"
                      data-type="theme" [attr.data-id]="book.id" (click)="createReservation(book)">Reserve</button>
                    }
                    @if (isReservedByCurrentUser) {
                    <a href="#" class="btn btn-dark btn-lg my-2 mr-2 text-oswald btn-wide js-ht-download-link"
                      data-type="theme" data-id="{{ book.id }}">Return</a>
                    <a href="#" class="btn btn-dark btn-lg my-2 mr-2 text-oswald btn-wide js-ht-download-link"
                      data-type="theme" data-id="{{ book.id }}">Rate</a>
                    }
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- RIGHT SIDE -->
        <div class="col-md-6 col-lg-6 order-1 order-md-2">
          <section style="background-color: #ffffff">
            <div class="container my-5 py-5 text-dark" id="rightSide">
              <div class="row d-flex justify-content-center overflow-auto">
                <div class="col-md-12 col-lg-10 col-xl-8 ">
                  <div class="d-flex justify-content-between align-items-center mb-4">
                    <h4 class="text-dark mb-0">Comments ({{ ratings.length }})</h4>
                  </div>
                  @for (rating of ratings; track $index) {
                  <div class="card mb-3">
                    <div class="card-body">
                      <div class="d-flex flex-start">
                        <div class="w-100">
                          <div class="d-flex justify-content-between align-items-center mb-3">
                            <h6 class="text-primary fw-bold mb-0" id="comments">
                              {{ rating.user.username }}
                              <span class="text-dark ms-2">{{ rating.comment }}</span>
                            </h6>
                            <p class="small mb-0 d-flex">
                              @for (star of getStarArray(5); track $index) {
                              <i class="bi bi-star-fill"
                                [style.color]="$index <= rating.score ? '#e5e10a' : '#b4b4b4'"></i>
                              }
                            </p>
                          </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    }
                    </div>
                  </div>
                </div>
              @if(rating){
              <div id="div-centrado">
                <form>
                  <div class="form-group">
                    <label for="exampleFormControlSelect1">Rating:</label>
                    <select class="form-control" id="exampleFormControlSelect1" [(ngModel)]="ratingToAdd.score"
                      [ngModelOptions]="{standalone: true}">
                      <option>1</option>
                      <option>2</option>
                      <option>3</option>
                      <option>4</option>
                      <option>5</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label for="exampleFormControlTextarea1">What's your opinion?</label>
                    <textarea class="form-control" id="exampleFormControlTextarea1" rows="3"
                      [(ngModel)]="ratingToAdd.comment" [ngModelOptions]="{standalone: true}"></textarea>
                  </div>
                  <button type="button" class="btn btn-danger" (click)="rating=false">Cancel</button>
                  <button type="button" class="btn btn-primary" (click)="addRating()">Submit</button>
                </form>
              </div>
              }
          </section>
        </div>
      </div>
    </div>
  </div>
</div>

